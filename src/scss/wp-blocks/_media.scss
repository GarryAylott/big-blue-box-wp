@use "utilities" as *;

/* 
STANDARD IMAGES RESET
Styles for general post images with captions
*/
.entry-content {
    figure,
    .wp-post-image figure {
        max-width: 100%;
        inline-size: fit-content;
        margin-inline: auto;
        padding-block-start: var(--space-m);
        margin-block-end: var(--space-l);

        figcaption {
            contain: inline-size;
            font-size: var(--step--1);
            font-style: italic;
            color: var(--clr-text-900);
            margin-block-start: var(--space-xs);
        }
    }

    figure,
    figure img,
    iframe,
    .wp-block-cover,
    img {
        border-radius: var(--radius-normal);
    }
}

/* 
BLOCK IMAGES RESET
Overrides for WP's default block images and videos/iframes
*/
.entry-content {
    figure.wp-caption,
    .wp-block-image img {
        max-width: 100%;
        height: auto;
        display: block;
    }

    figure.aligncenter img {
        margin-inline: auto;
    }

    .wp-block-embed {
        position: relative;
        width: 100%;
        overflow: hidden;

        iframe {
            display: block;
            width: 100%;
            height: auto;
            aspect-ratio: 16 / 9;
        }

        figcaption {
            margin-block-end: 0;
            margin-block-start: var(--space-xs);
        }
    }
}

/* 
IMAGE GALLERY
Custom gallery styles overriding WordPress defaults
*/
.entry-content .wp-block-gallery,
.entry-content .wp-block-gallery.has-nested-images {
    display: flex;
    flex-wrap: wrap;
    // gap: var(--space-s);
    padding-block-start: var(--space-s);
    list-style: none;

    figure.wp-block-image {
        flex: 1 1 260px; // min width remains but allows items to stretch to fill rows
        width: 100%;
        margin: 0;
        padding: 0;
        overflow: hidden;

        &:before {
            @include visually-hidden;
        }

        img {
            display: block;
            width: 100%;
            height: auto;
            object-fit: cover;
            /* Optional: enforce a consistent tile ratio.
         Comment this out if you want images to keep their natural proportions. */
            aspect-ratio: 4 / 3;
        }

        figcaption {
            position: initial;
            font-size: var(--step--1);
            line-height: 1.4;
            text-align: center;
            text-shadow: none;
            color: var(--clr-text-900, #666);
            background: none;
            margin: 0;
            margin-block-start: var(--space-xs);
            padding: 0;
        }
    }

    figcaption.blocks-gallery-caption {
        margin-block-start: var(--space-2xs);
    }
}

/* 
IMAGE COVER
Custom image cover styles overriding WordPress defaults
*/
.entry-content .wp-block-cover {
    position: relative;
    margin-block-start: var(--space-xl);
    // border-radius: var(--radius-normal);

    .wp-block-cover__inner-container {
        position: absolute;
        width: fit-content;
        right: var(--space-xs);
        bottom: var(--space-xs);
        left: var(--space-xs);
        background: hsl(var(--clr-brand-primary-darker-hsl) / 0.7);
        backdrop-filter: blur(5px) saturate(150%) brightness(180%) blur(10px);
        -webkit-backdrop-filter: blur(10px) saturate(130%) brightness(150%);
        padding-block: var(--space-2xs);
        padding-inline: var(--space-xs);
        border-radius: var(--radius-small);

        p.has-large-font-size {
            font-family: var(--font-family-headings);
            font-size: var(--step-1) !important;
            font-weight: var(--fw-semibold);
            line-height: 1.3;
        }
    }

    span.wp-block-cover__background {
        background-color: hsl(221, 91%, 70%) !important;
        opacity: 0.3;
    }
}
